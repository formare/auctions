%
\begin{isabellebody}%
\def\isabellecontext{Discrete}%
%
\isamarkupheader{Common discrete functions%
}
\isamarkuptrue%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Discrete\isanewline
\isakeyword{imports}\ Main\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isamarkupsubsection{Discrete logarithm%
}
\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ log\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isacharbrackleft}simp\ del{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}log\ n\ {\isacharequal}\ {\isacharparenleft}if\ n\ {\isacharless}\ {\isadigit{2}}\ then\ {\isadigit{0}}\ else\ Suc\ {\isacharparenleft}log\ {\isacharparenleft}n\ div\ {\isadigit{2}}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ log{\isacharunderscore}zero\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}log\ {\isadigit{0}}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ log{\isachardot}simps{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ log{\isacharunderscore}one\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}log\ {\isadigit{1}}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ log{\isachardot}simps{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ log{\isacharunderscore}Suc{\isacharunderscore}zero\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}log\ {\isacharparenleft}Suc\ {\isadigit{0}}{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ log{\isacharunderscore}one\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ log{\isacharunderscore}rec{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}n\ {\isasymge}\ {\isadigit{2}}\ {\isasymLongrightarrow}\ log\ n\ {\isacharequal}\ Suc\ {\isacharparenleft}log\ {\isacharparenleft}n\ div\ {\isadigit{2}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ log{\isachardot}simps{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ log{\isacharunderscore}twice\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}n\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ log\ {\isacharparenleft}{\isadigit{2}}\ {\isacharasterisk}\ n{\isacharparenright}\ {\isacharequal}\ Suc\ {\isacharparenleft}log\ n{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ log{\isacharunderscore}rec{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ log{\isacharunderscore}half\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}log\ {\isacharparenleft}n\ div\ {\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ log\ n\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}n\ {\isacharless}\ {\isadigit{2}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}n\ {\isacharequal}\ {\isadigit{0}}\ {\isasymor}\ n\ {\isacharequal}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ arith\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ del{\isacharcolon}\ One{\isacharunderscore}nat{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ log{\isacharunderscore}rec{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ log{\isacharunderscore}exp\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}log\ {\isacharparenleft}{\isadigit{2}}\ {\isacharcircum}\ n{\isacharparenright}\ {\isacharequal}\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n{\isacharparenright}\ simp{\isacharunderscore}all%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ log{\isacharunderscore}mono{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}mono\ log{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ m\ n\ {\isacharcolon}{\isacharcolon}\ nat\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}m\ {\isasymle}\ n{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}log\ m\ {\isasymle}\ log\ n{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induct\ m\ arbitrary{\isacharcolon}\ n\ rule{\isacharcolon}\ log{\isachardot}induct{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\isadigit{1}}\ m{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ mn{\isadigit{2}}{\isacharcolon}\ {\isachardoublequoteopen}m\ div\ {\isadigit{2}}\ {\isasymle}\ n\ div\ {\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ arith\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}log\ m\ {\isasymle}\ log\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}m\ {\isacharless}\ {\isadigit{2}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}m\ {\isacharequal}\ {\isadigit{0}}\ {\isasymor}\ m\ {\isacharequal}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ arith\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ del{\isacharcolon}\ One{\isacharunderscore}nat{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ mn{\isadigit{2}}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}m\ {\isasymge}\ {\isadigit{2}}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}n\ {\isasymge}\ {\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\ arith\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ False\ \isacommand{have}\isamarkupfalse%
\ m{\isadigit{2}}{\isacharunderscore}{\isadigit{0}}{\isacharcolon}\ {\isachardoublequoteopen}m\ div\ {\isadigit{2}}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ arith\isanewline
\ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ mn{\isadigit{2}}\ \isacommand{have}\isamarkupfalse%
\ n{\isadigit{2}}{\isacharunderscore}{\isadigit{0}}{\isacharcolon}\ {\isachardoublequoteopen}n\ div\ {\isadigit{2}}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ arith\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ False\ {\isachardoublequoteopen}{\isadigit{1}}{\isachardot}hyps{\isachardoublequoteclose}\ mn{\isadigit{2}}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}log\ {\isacharparenleft}m\ div\ {\isadigit{2}}{\isacharparenright}\ {\isasymle}\ log\ {\isacharparenleft}n\ div\ {\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ m{\isadigit{2}}{\isacharunderscore}{\isadigit{0}}\ n{\isadigit{2}}{\isacharunderscore}{\isadigit{0}}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}log\ {\isacharparenleft}{\isadigit{2}}\ {\isacharasterisk}\ {\isacharparenleft}m\ div\ {\isadigit{2}}{\isacharparenright}{\isacharparenright}\ {\isasymle}\ log\ {\isacharparenleft}{\isadigit{2}}\ {\isacharasterisk}\ {\isacharparenleft}n\ div\ {\isadigit{2}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ m{\isadigit{2}}{\isacharunderscore}{\isadigit{0}}\ n{\isadigit{2}}{\isacharunderscore}{\isadigit{0}}\ {\isacharbackquoteopen}m\ {\isasymge}\ {\isadigit{2}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}n\ {\isasymge}\ {\isadigit{2}}{\isacharbackquoteclose}\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ only{\isacharcolon}\ log{\isacharunderscore}rec\ {\isacharbrackleft}of\ m{\isacharbrackright}\ log{\isacharunderscore}rec\ {\isacharbrackleft}of\ n{\isacharbrackright}{\isacharparenright}\ simp\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isamarkupsubsection{Discrete square root%
}
\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ sqrt\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\isanewline
\isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}sqrt\ n\ {\isacharequal}\ Max\ {\isacharbraceleft}m{\isachardot}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sqrt{\isacharunderscore}aux{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ n\ {\isacharcolon}{\isacharcolon}\ nat\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}finite\ {\isacharbraceleft}m{\isachardot}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharbraceright}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}{\isacharbraceleft}m{\isachardot}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharbraceright}\ {\isasymnoteq}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\ \isacommand{fix}\isamarkupfalse%
\ m\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}m\ {\isasymle}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ m{\isacharparenright}\ {\isacharparenleft}simp{\isacharunderscore}all\ add{\isacharcolon}\ power{\isadigit{2}}{\isacharunderscore}eq{\isacharunderscore}square{\isacharparenright}\isanewline
\ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ {\isacharasterisk}{\isacharasterisk}\ {\isacharequal}\ this\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}m{\isachardot}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharbraceright}\ {\isasymsubseteq}\ {\isacharbraceleft}m{\isachardot}\ m\ {\isasymle}\ n{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}finite\ {\isacharbraceleft}m{\isachardot}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ finite{\isacharunderscore}subset{\isacharparenright}\ rule\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharbraceleft}m{\isachardot}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharbraceright}\ {\isasymnoteq}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}code{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}sqrt\ n\ {\isacharequal}\ Max\ {\isacharparenleft}Set{\isachardot}filter\ {\isacharparenleft}{\isasymlambda}m{\isachardot}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharparenright}\ {\isacharbraceleft}{\isadigit{0}}{\isachardot}{\isachardot}n{\isacharbraceright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ power{\isadigit{2}}{\isacharunderscore}nat{\isacharunderscore}le{\isacharunderscore}imp{\isacharunderscore}le\ {\isacharbrackleft}of\ {\isacharunderscore}\ n{\isacharbrackright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}m{\isachardot}\ m\ {\isasymle}\ n\ {\isasymand}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}m{\isachardot}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ sqrt{\isacharunderscore}def\ Set{\isachardot}filter{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sqrt{\isacharunderscore}inverse{\isacharunderscore}power{\isadigit{2}}\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}sqrt\ {\isacharparenleft}n\isactrlsup {\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}m{\isachardot}\ m\ {\isasymle}\ n{\isacharbraceright}\ {\isasymnoteq}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Max\ {\isacharbraceleft}m{\isachardot}\ m\ {\isasymle}\ n{\isacharbraceright}\ {\isasymle}\ n{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ sqrt{\isacharunderscore}def\ power{\isadigit{2}}{\isacharunderscore}nat{\isacharunderscore}le{\isacharunderscore}eq{\isacharunderscore}le\ intro{\isacharcolon}\ antisym{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mono{\isacharunderscore}sqrt{\isacharcolon}\ {\isachardoublequoteopen}mono\ sqrt{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ m\ n\ {\isacharcolon}{\isacharcolon}\ nat\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharasterisk}\ {\isadigit{0}}\ {\isasymle}\ m{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}m\ {\isasymle}\ n{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}sqrt\ m\ {\isasymle}\ sqrt\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ intro{\isacharbang}{\isacharcolon}\ Max{\isacharunderscore}mono\ {\isacharbackquoteopen}{\isadigit{0}}\ {\isacharasterisk}\ {\isadigit{0}}\ {\isasymle}\ m{\isacharbackquoteclose}\ finite{\isacharunderscore}less{\isacharunderscore}ub\ simp\ add{\isacharcolon}\ power{\isadigit{2}}{\isacharunderscore}eq{\isacharunderscore}square\ sqrt{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sqrt{\isacharunderscore}greater{\isacharunderscore}zero{\isacharunderscore}iff\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}sqrt\ n\ {\isachargreater}\ {\isadigit{0}}\ {\isasymlongleftrightarrow}\ n\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}\ Max\ {\isacharbraceleft}m{\isachardot}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharbraceright}\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\isasymexists}a{\isasymin}{\isacharbraceleft}m{\isachardot}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharbraceright}{\isachardot}\ {\isadigit{0}}\ {\isacharless}\ a{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ Max{\isacharunderscore}gr{\isacharunderscore}iff{\isacharparenright}\ {\isacharparenleft}fact\ sqrt{\isacharunderscore}aux{\isacharparenright}{\isacharplus}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}\ sqrt\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}\ Max\ {\isacharbraceleft}m{\isachardot}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ sqrt{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ {\isacharasterisk}\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}\ n{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ dest{\isacharcolon}\ power{\isadigit{2}}{\isacharunderscore}nat{\isacharunderscore}le{\isacharunderscore}imp{\isacharunderscore}le{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}\isactrlsup {\isadigit{2}}\ {\isasymle}\ n\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}\ {\isacharparenleft}{\isadigit{1}}{\isacharcolon}{\isacharcolon}nat{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}q{\isachardot}\ q\isactrlsup {\isadigit{2}}\ {\isasymle}\ n\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}\ q{\isachardoublequoteclose}\ \isacommand{{\isachardot}{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ {\isacharasterisk}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}\ Max\ {\isacharbraceleft}m{\isachardot}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}\ sqrt\ n{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ \ {\isacharparenleft}simp\ add{\isacharcolon}\ sqrt{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sqrt{\isacharunderscore}power{\isadigit{2}}{\isacharunderscore}le\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}sqrt\ n{\isacharparenright}\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}n\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ sqrt{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sqrt\ n\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}mono\ {\isacharparenleft}times\ {\isacharparenleft}Max\ {\isacharbraceleft}m{\isachardot}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharbraceright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ intro{\isacharcolon}\ mono{\isacharunderscore}times{\isacharunderscore}nat\ simp\ add{\isacharcolon}\ sqrt{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}Max\ {\isacharbraceleft}m{\isachardot}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharbraceright}\ {\isacharasterisk}\ Max\ {\isacharbraceleft}m{\isachardot}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharbraceright}\ {\isacharequal}\ Max\ {\isacharparenleft}times\ {\isacharparenleft}Max\ {\isacharbraceleft}m{\isachardot}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharbraceright}{\isacharparenright}\ {\isacharbackquote}\ {\isacharbraceleft}m{\isachardot}\ m\isactrlsup {\isadigit{2}}\ {\isasymle}\ n{\isacharbraceright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ sqrt{\isacharunderscore}aux\ {\isacharbrackleft}of\ n{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ mono{\isacharunderscore}Max{\isacharunderscore}commute{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Max\ {\isacharparenleft}op\ {\isacharasterisk}\ {\isacharparenleft}Max\ {\isacharbraceleft}m{\isachardot}\ m\ {\isacharasterisk}\ m\ {\isasymle}\ n{\isacharbraceright}{\isacharparenright}\ {\isacharbackquote}\ {\isacharbraceleft}m{\isachardot}\ m\ {\isacharasterisk}\ m\ {\isasymle}\ n{\isacharbraceright}{\isacharparenright}\ {\isasymle}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}subst\ Max{\isacharunderscore}le{\isacharunderscore}iff{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}mono{\isacharunderscore}tags{\isacharparenright}\ finite{\isacharunderscore}imageI\ finite{\isacharunderscore}less{\isacharunderscore}ub\ le{\isacharunderscore}square{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}metis\ le{\isadigit{0}}\ mult{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}right{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ q\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}q\ {\isacharasterisk}\ q\ {\isasymle}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}Max\ {\isacharbraceleft}m{\isachardot}\ m\ {\isacharasterisk}\ m\ {\isasymle}\ n{\isacharbraceright}\ {\isacharasterisk}\ q\ {\isasymle}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}q\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}mono\ {\isacharparenleft}times\ q{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ mono{\isacharunderscore}times{\isacharunderscore}nat{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}q\ {\isacharasterisk}\ Max\ {\isacharbraceleft}m{\isachardot}\ m\ {\isacharasterisk}\ m\ {\isasymle}\ n{\isacharbraceright}\ {\isacharequal}\ Max\ {\isacharparenleft}times\ q\ {\isacharbackquote}\ {\isacharbraceleft}m{\isachardot}\ m\ {\isacharasterisk}\ m\ {\isasymle}\ n{\isacharbraceright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ sqrt{\isacharunderscore}aux\ {\isacharbrackleft}of\ n{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ power{\isadigit{2}}{\isacharunderscore}eq{\isacharunderscore}square\ intro{\isacharcolon}\ mono{\isacharunderscore}Max{\isacharunderscore}commute{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Max\ {\isacharbraceleft}m{\isachardot}\ m\ {\isacharasterisk}\ m\ {\isasymle}\ n{\isacharbraceright}\ {\isacharasterisk}\ q\ {\isacharequal}\ Max\ {\isacharparenleft}times\ q\ {\isacharbackquote}\ {\isacharbraceleft}m{\isachardot}\ m\ {\isacharasterisk}\ m\ {\isasymle}\ n{\isacharbraceright}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ ac{\isacharunderscore}simps{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}subst\ Max{\isacharunderscore}le{\isacharunderscore}iff{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}mono{\isacharunderscore}tags{\isacharparenright}\ finite{\isacharunderscore}imageI\ finite{\isacharunderscore}less{\isacharunderscore}ub\ le{\isacharunderscore}square{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharbackquoteopen}q\ {\isacharasterisk}\ q\ {\isasymle}\ n{\isacharbackquoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}q\ {\isacharasterisk}\ q\ {\isasymle}\ n{\isacharbackquoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ le{\isacharunderscore}cases\ mult{\isacharunderscore}le{\isacharunderscore}mono{\isadigit{1}}\ mult{\isacharunderscore}le{\isacharunderscore}mono{\isadigit{2}}\ order{\isacharunderscore}trans{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ {\isacharasterisk}\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ sqrt{\isacharunderscore}def\ power{\isadigit{2}}{\isacharunderscore}eq{\isacharunderscore}square{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sqrt{\isacharunderscore}le{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}sqrt\ n\ {\isasymle}\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ sqrt{\isacharunderscore}aux\ {\isacharbrackleft}of\ n{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ sqrt{\isacharunderscore}def\ intro{\isacharcolon}\ power{\isadigit{2}}{\isacharunderscore}nat{\isacharunderscore}le{\isacharunderscore}imp{\isacharunderscore}le{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{hide{\isacharunderscore}const}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{open}{\isacharparenright}\ log\ sqrt\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
\end{isabellebody}%
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "root"
%%% End:
