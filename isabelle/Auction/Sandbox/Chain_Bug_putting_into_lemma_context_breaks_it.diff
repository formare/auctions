--- Chain_Bug_2_works.thy	2013-09-07 16:15:09.082285000 +0200
+++ Chain_Bug_4_fails.thy	2013-09-07 16:23:16.024231000 +0200
@@ -1,4 +1,4 @@
-theory Chain_Bug_2_works
+theory Chain_Bug_4_fails
 imports Main
 begin
 
@@ -13,9 +13,10 @@
 definition injections :: "'a set \<Rightarrow> 'b set \<Rightarrow> ('a \<times> 'b) set set"
 where "injections X Y = {R . Domain R = X \<and> Range R \<subseteq> Y \<and> runiq R \<and> runiq (R\<inverse>)}"
 
-notepad
-begin
-  fix Y::"'b set"
+lemma
+  fixes Y::"'b set"
+  shows "{{}} = injections {} Y"
+proof -
   have "{{}} = {R::('a \<times> 'b) set. Domain R = {} \<and> Range R \<subseteq> Y \<and> runiq R \<and> runiq (R\<inverse>)}" (is "?LHS = ?RHS")
   proof
     have "Domain {} = {}" by simp
@@ -38,5 +39,7 @@
   qed
   also have "{R . Domain R = {} \<and> Range R \<subseteq> Y \<and> runiq R \<and> runiq (R\<inverse>)} = injections {} Y"
     unfolding injections_def ..
-  finally have "{{}} = injections {} Y" .
+  finally show "{{}} = injections {} Y" sorry
+qed
+
 end
